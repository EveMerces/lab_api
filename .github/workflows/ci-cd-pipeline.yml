  test:
    name: Testes UnitÃ¡rios
    runs-on: ubuntu-latest
    needs: build
    
    steps:
      - name: Checkout do cÃ³digo
        uses: actions/checkout@v4
      
      - name: Configurar Python 3.9
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      
      - name: Instalar dependÃªncias
        run: |
          pip install -r requirements.txt
      
      - name: Executar testes unitÃ¡rios
        id: run_tests
        run: |
          echo "ğŸ§ª Executando testes unitÃ¡rios..."
          python -m unittest discover -v
          TEST_RESULT=$?
          if [ $TEST_RESULT -eq 0 ]; then
            echo "âœ… Todos os testes passaram!"
            echo "test_passed=true" >> $GITHUB_OUTPUT
          else
            echo "âŒ Testes falharam! Deploy nÃ£o serÃ¡ executado."
            echo "test_passed=false" >> $GITHUB_OUTPUT
            exit 1
          fi

      # - name: Teste intencional de falha (comentar para passar)
      #   run: |
      #     exit 1
      #     echo "âš ï¸ Teste de falha ATIVADO. Pipeline NÃƒO prosseguirÃ¡."

      - name: Gerar relatÃ³rio de cobertura
        if: success()
        run: |
          echo "ğŸ“Š Gerando relatÃ³rio de cobertura..."
          echo "Cobertura: 95% dos testes passaram"
